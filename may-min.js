(function(g){function e(a,b){if(e.exists(a))throw a+" has defined";var c=b||eval(a);g[a]=c;c=e["@variables"];-1==c.indexOf(a)&&c.push(a)}function p(a){var a=a||this,b="_temp"+Date.now();eval(b+"={value: {}}");eval(b).value=a;return"var "+(d.get(a,"dsl")||Object.keys(a)).map(function(a){return a+"="+b+".value['"+a+"']"}).join(",")+"; delete "+b}function q(a,b){var c={},h;for(h in a)c[h]=b?q(a[h]):a[h];return c}function j(a,b,c){if(!a)return b;var h;if(c&&0<c.length)for(h in a)-1==c.indexOf(h)&&(b[h]=
a[h]);else for(h in a)b[h]=a[h];return b}function m(a,b,c){b=q(b);j(a||{},b,c);return b}function r(a,b,c){var c=m(c,m(a.includeOption,{methodize:!1,context:b,methodizeTo:null})),h=c.methodize;Object.keys(a).forEach(function(d){if(!/^__.*__$/.test(d)&&-1==["onIncluded","includeOption"].indexOf(d)){var f=a[d];if(h&&"function"==typeof f){var e=c.context,g=c.methodizeTo;b[d]=function(){e=e||this;var a=[g?g(e):e].concat(Array.prototype.slice.call(arguments,0));return f.apply(null,a)}}else b[d]=a[d]}});
d.has("protocols")&&d.get("protocols").forEach(function(a){s(a,b)});a.onIncluded&&a.onIncluded.call(b,c.context)}function s(a,b){d.has("protocols")||d.set(b,"protocols",[]);var c=d.get(b,"protocols");-1==c.indexOf(a)&&n(a,b)&&c.push(a)}function t(a){var b=a["@base"]||(a["@base"]=i);delete a["@base"];var c=Object.create(b);d.has(c,"proto")||d.set(c,"proto",b,!0);j(a,c);d.set(c,"protocols",[]);return c}function u(a,b){if(a===b)return!0;if(null===a)return null===b;var c=!1;switch(typeof a){case "string":c=
typeof b==a;break;case "object":c=v.isPrototypeOf(a)?n(a,b):a.isPrototypeOf(b);break;case "function":c=(c=a.prototype)?c.isPrototypeOf(b):b instanceof a}return c}function n(a,b){if(d.has(b,"protocols")&&-1!=d.get(b,"protocols").indexOf(a))return!0;if(a["@base"]&&!n(a["@base"],b))return!1;Object.keys(b).filter(function(a){return"@base"!==a}).forEach(function(c){if(!u(a[c],b[c]))return!1});return!0}function w(a){var b=typeof a,c=a;-1==["object","function"].indexOf(b)&&(c=new (eval(b.charAt(0).toUpperCase()+
b.slice(1)))(a));return c}function f(a){var b=f.findWrappersByObj(a),a=w(a);if(0===b.length)return a;var c=i.create();b.forEach(function(b){c.include(b.module,m(b.includeOption,{context:a},["context"]))});return c}var k={},d={_parseName:function(a){/^__.*__$/.test(a)||(a="__"+a+"__");return a},has:function(a,b){return a.hasOwnProperty(this._parseName(b))},get:function(a,b){return a[this._parseName(b)]},set:function(a,b,c,d){Object.defineProperty(a,this._parseName(b),{value:c,writable:!0!==d})}};e.exists=
function(a){return g.hasOwnProperty?g.hasOwnProperty(a):"undefined"!==typeof g[a]};e["@variables"]=[];e.del=function(a){var b=e["@variables"].indexOf(objName);if(0<=b){var c=e["@variables"];0===b?c.shift():b==c.length-1?c.pop():e["@variables"]=c.slice(0,b)+c.slice(b+1);g[a]=null;delete g[a];return!0}return!1};e.list=function(){return[].concat(e["@variables"])};e("Mayjs",k);g.global={};e("$run",function(a,b){return a.call(b||{})});var i={initialize:function(){d.set(this,"protocols",[])},_callerOwner:function(a){var b=
null;a:for(var c=function(c){Object.keys(c).forEach(function(d){if(c[d]==a)return b=c,a["@name"]=d,!1});if(b)return!1},d=this;d;){if(!1===c(d))break a;d=d.__proto__}return b},protoMember:function(a){var b=this._callerOwner(arguments.callee.caller);if(b&&(proto=d.get(b,"proto")))return proto[a]},base:function(){var a=arguments.callee.caller,b=this._callerOwner(a),c=a["@name"];delete a["@name"];c=(a=b?d.get(b,"proto"):null)?a[c]:null;if(u("function",c))return c.apply(this,arguments)},create:function(){var a=
Object.create(this);i.initialize.call(a);d.has(a,"proto")||d.set(a,"proto",this,!0);this.initialize&&this.initialize.apply(a,arguments);return a},include:function(a,b){r(a,this,b);return this},implement:function(a){s(a,this);return this},supported:function(a){return-1!=this.meta("protocols").indexOf(a)},meta:function(a){return d.get(this,a)},dsl:p,"@base":Object.prototype},i=t(i),v=t({initialize:function(a){j(a,this)}}),l=v.create({initialize:Function,create:Function,include:Function,implement:Function,
prototype:Object,__protocols__:Array});i.implement(l);d.set(f,"map",{});f.findWrappersByType=function(a){return d.get(f,"map")[a]||[]};f.findWrappersByPrototype=function(a){for(var b=[],c;a&&!(b=b.concat(f.findWrappersByType(a)),c=a,a=c.prototype||(c.constructor?c.constructor.prototype:null),a==c););return b};f.findWrappersByObj=function(a){if(null===a)return[];var b=[],c=typeof a;"object"==c?(b=b.concat(f.findWrappersByPrototype(a.prototype||a.constructor.prototype)),d.has(a,"protocols")&&d.get(a,
"protocols").forEach(function(a){b=b.concat(f.findWrappersByType(a))})):b=b.concat(f.findWrappersByType(c));return b};f.exists=function(a,b){var c=d.get(f,"map")[a];return!c||1>c.length?!1:0<c.filter(function(a){return a.module==b}).length};f.regist=function(a,b,c){if(a&&-1!=["string","object"].indexOf(typeof a)&&"object"==typeof b){var e=d.get(f,"map"),g=e[a];g||(g=e[a]=[]);f.exists(a,b)||g.push({module:b,includeOption:c});return this}};j(f,function(a){var b=f.findWrappersByObj(a),a=w(a);if(0===
b.length)return a;b.forEach(function(b){a.include?a.include(b.module,b.includeOption):r(b.module,a,b.includeOption)});return a});l="$run $fn $parseArray $trace $methodize $module $proto $obj $merge $implement $include $protocol $is $support $dsl $overload $ $$ $enum $global $meta IBase Base Protocol".split(" ");l.forEach(function(a){k[a]=eval(a)});k.dsl=p;d.set(k,"dsl",l.filter(function(a){return"$"===a.charAt(0)}));if(!e.exists("console")){var x={};"info log error debug warn trace dir".split(" ").forEach(function(){x.name=
function(){}});e("console",x)}})(this);
